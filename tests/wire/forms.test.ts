/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool.js";
import { SamsaraClient } from "../../src/Client";

describe("Forms", () => {
    test("getFormTemplates", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({ token: "test", version: "2025-05-12", environment: server.baseUrl });

        const rawResponseBody = {
            data: [
                {
                    approvalConfig: {
                        singleApprovalConfig: {
                            allowManualApproverSelection: true,
                            requirements: { roleIds: ["23d4d8d3-dc10-4e7a-a183-69968751f23e"] },
                        },
                        type: "singleApproval",
                    },
                    createdAtTime: "2019-06-13T19:08:25Z",
                    createdBy: { id: "938172", type: "driver" },
                    description: "This is a form template description.",
                    fields: [
                        {
                            allowManualEntry: true,
                            autofillFromId: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                            columns: [
                                {
                                    allowManualEntry: true,
                                    filterByRoleIds: ["23d4d8d3-dc10-4e7a-a183-69968751f23e"],
                                    id: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                                    includeDrivers: true,
                                    includeUsers: true,
                                    label: "Engine Hours",
                                    numDecimalPlaces: 2,
                                    options: [
                                        {
                                            id: "e879028d-bce5-0238-ffec-11cd9236bcda",
                                            ignoreQuestionFromScoreIfSelected: false,
                                            label: "Yes",
                                            optionScoreWeight: 5,
                                        },
                                    ],
                                    type: "number",
                                },
                            ],
                            filterByRoleIds: ["23d4d8d3-dc10-4e7a-a183-69968751f23e"],
                            id: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                            includeDrivers: true,
                            includeUsers: true,
                            isAutofillSource: true,
                            isRequired: true,
                            label: "Engine Hours",
                            numDecimalPlaces: 2,
                            options: [
                                {
                                    id: "e879028d-bce5-0238-ffec-11cd9236bcda",
                                    ignoreQuestionFromScoreIfSelected: false,
                                    label: "Yes",
                                    optionScoreWeight: 5,
                                },
                            ],
                            questionWeight: 5,
                            type: "number",
                        },
                    ],
                    id: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                    revisionId: "1214a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                    sections: [
                        {
                            fieldIndexFirstInclusive: 0,
                            fieldIndexLastInclusive: 9,
                            id: "dbab5bc8-e41c-4b52-bfa5-fd2c7e809b00",
                            label: "Engine Hours",
                        },
                    ],
                    title: "Form Template Title",
                    updatedAtTime: "2019-06-13T19:08:25Z",
                    updatedBy: { id: "938172", type: "driver" },
                },
            ],
            pagination: { endCursor: "MjkY", hasNextPage: true },
        };
        server.mockEndpoint().get("/form-templates").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.forms.getFormTemplates();
        expect(response).toEqual({
            data: [
                {
                    approvalConfig: {
                        singleApprovalConfig: {
                            allowManualApproverSelection: true,
                            requirements: {
                                roleIds: ["23d4d8d3-dc10-4e7a-a183-69968751f23e"],
                            },
                        },
                        type: "singleApproval",
                    },
                    createdAtTime: "2019-06-13T19:08:25Z",
                    createdBy: {
                        id: "938172",
                        type: "driver",
                    },
                    description: "This is a form template description.",
                    fields: [
                        {
                            allowManualEntry: true,
                            autofillFromId: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                            columns: [
                                {
                                    allowManualEntry: true,
                                    filterByRoleIds: ["23d4d8d3-dc10-4e7a-a183-69968751f23e"],
                                    id: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                                    includeDrivers: true,
                                    includeUsers: true,
                                    label: "Engine Hours",
                                    numDecimalPlaces: 2,
                                    options: [
                                        {
                                            id: "e879028d-bce5-0238-ffec-11cd9236bcda",
                                            ignoreQuestionFromScoreIfSelected: false,
                                            label: "Yes",
                                            optionScoreWeight: 5,
                                        },
                                    ],
                                    type: "number",
                                },
                            ],
                            filterByRoleIds: ["23d4d8d3-dc10-4e7a-a183-69968751f23e"],
                            id: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                            includeDrivers: true,
                            includeUsers: true,
                            isAutofillSource: true,
                            isRequired: true,
                            label: "Engine Hours",
                            numDecimalPlaces: 2,
                            options: [
                                {
                                    id: "e879028d-bce5-0238-ffec-11cd9236bcda",
                                    ignoreQuestionFromScoreIfSelected: false,
                                    label: "Yes",
                                    optionScoreWeight: 5,
                                },
                            ],
                            questionWeight: 5,
                            type: "number",
                        },
                    ],
                    id: "9814a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                    revisionId: "1214a1fa-f0c6-408b-bf85-51dc3bc71ac7",
                    sections: [
                        {
                            fieldIndexFirstInclusive: 0,
                            fieldIndexLastInclusive: 9,
                            id: "dbab5bc8-e41c-4b52-bfa5-fd2c7e809b00",
                            label: "Engine Hours",
                        },
                    ],
                    title: "Form Template Title",
                    updatedAtTime: "2019-06-13T19:08:25Z",
                    updatedBy: {
                        id: "938172",
                        type: "driver",
                    },
                },
            ],
            pagination: {
                endCursor: "MjkY",
                hasNextPage: true,
            },
        });
    });
});
