// This file was auto-generated by Fern from our API Definition.

import { SamsaraClient } from "../../src/Client";
import { mockServerPool } from "../mock-server/MockServerPool";

describe("AttributesClient", () => {
    test("getAttributesByEntityType", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });

        const rawResponseBody = {
            data: [
                {
                    attributeType: "single-select",
                    entityType: "driver",
                    id: "123e4567-e89b-12d3-a456-426614174000",
                    name: "License Certifications",
                    numberValues: [1.1],
                    stringValues: ["stringValues"],
                    unit: "NO_UNIT",
                    values: [{ id: "123e4567-e89b-12d3-a456-426614174000", stringValue: "CDL" }],
                },
            ],
            pagination: { endCursor: "MjkY", hasNextPage: true },
        };
        server.mockEndpoint().get("/attributes").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.attributes.getAttributesByEntityType({
            entityType: "driver",
        });
        expect(response).toEqual({
            data: [
                {
                    attributeType: "single-select",
                    entityType: "driver",
                    id: "123e4567-e89b-12d3-a456-426614174000",
                    name: "License Certifications",
                    numberValues: [1.1],
                    stringValues: ["stringValues"],
                    unit: "NO_UNIT",
                    values: [
                        {
                            id: "123e4567-e89b-12d3-a456-426614174000",
                            stringValue: "CDL",
                        },
                    ],
                },
            ],
            pagination: {
                endCursor: "MjkY",
                hasNextPage: true,
            },
        });
    });

    test("createAttribute", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });
        const rawRequestBody = { attributeType: "single-select", entityType: "driver", name: "License Certifications" };
        const rawResponseBody = {
            data: {
                entities: [{}],
                attributeType: "single-select",
                entityType: "driver",
                id: "123e4567-e89b-12d3-a456-426614174000",
                name: "License Certifications",
                numberValues: [1.1],
                stringValues: ["stringValues"],
                unit: "NO_UNIT",
                values: [{ id: "123e4567-e89b-12d3-a456-426614174000", stringValue: "CDL" }],
            },
        };
        server
            .mockEndpoint()
            .post("/attributes")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.attributes.createAttribute({
            attributeType: "single-select",
            entityType: "driver",
            name: "License Certifications",
        });
        expect(response).toEqual({
            data: {
                entities: [{}],
                attributeType: "single-select",
                entityType: "driver",
                id: "123e4567-e89b-12d3-a456-426614174000",
                name: "License Certifications",
                numberValues: [1.1],
                stringValues: ["stringValues"],
                unit: "NO_UNIT",
                values: [
                    {
                        id: "123e4567-e89b-12d3-a456-426614174000",
                        stringValue: "CDL",
                    },
                ],
            },
        });
    });

    test("getAttribute", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });

        const rawResponseBody = {
            data: {
                entities: [{}],
                attributeType: "single-select",
                entityType: "driver",
                id: "123e4567-e89b-12d3-a456-426614174000",
                name: "License Certifications",
                numberValues: [1.1],
                stringValues: ["stringValues"],
                unit: "NO_UNIT",
                values: [{ id: "123e4567-e89b-12d3-a456-426614174000", stringValue: "CDL" }],
            },
        };
        server.mockEndpoint().get("/attributes/id").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.attributes.getAttribute({
            id: "id",
            entityType: "driver",
        });
        expect(response).toEqual({
            data: {
                entities: [{}],
                attributeType: "single-select",
                entityType: "driver",
                id: "123e4567-e89b-12d3-a456-426614174000",
                name: "License Certifications",
                numberValues: [1.1],
                stringValues: ["stringValues"],
                unit: "NO_UNIT",
                values: [
                    {
                        id: "123e4567-e89b-12d3-a456-426614174000",
                        stringValue: "CDL",
                    },
                ],
            },
        });
    });

    test("delete", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });

        server.mockEndpoint().delete("/attributes/id").respondWith().statusCode(200).build();

        const response = await client.attributes.delete({
            id: "id",
            entityType: "driver",
        });
        expect(response).toEqual(undefined);
    });

    test("updateAttribute", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });
        const rawRequestBody = { entityType: "driver" };
        const rawResponseBody = {
            data: {
                entities: [{}],
                attributeType: "single-select",
                entityType: "driver",
                id: "123e4567-e89b-12d3-a456-426614174000",
                name: "License Certifications",
                numberValues: [1.1],
                stringValues: ["stringValues"],
                unit: "NO_UNIT",
                values: [{ id: "123e4567-e89b-12d3-a456-426614174000", stringValue: "CDL" }],
            },
        };
        server
            .mockEndpoint()
            .patch("/attributes/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.attributes.updateAttribute({
            id: "id",
            entityType: "driver",
        });
        expect(response).toEqual({
            data: {
                entities: [{}],
                attributeType: "single-select",
                entityType: "driver",
                id: "123e4567-e89b-12d3-a456-426614174000",
                name: "License Certifications",
                numberValues: [1.1],
                stringValues: ["stringValues"],
                unit: "NO_UNIT",
                values: [
                    {
                        id: "123e4567-e89b-12d3-a456-426614174000",
                        stringValue: "CDL",
                    },
                ],
            },
        });
    });
});
