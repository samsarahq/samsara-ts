/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../../mock-server/MockServerPool.js";
import { SamsaraApiClient } from "../../../src/Client";

describe("Safety", () => {
    test("get", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraApiClient({ token: "test", version: "2025-05-12", environment: server.baseUrl });

        const rawResponseBody = {
            data: [
                {
                    defaultVehicleType: "off",
                    distractedDrivingDetectionAlerts: { isEnabled: true },
                    followingDistanceDetectionAlerts: {
                        durationMs: 15000,
                        hasInCabAudioAlertsEnabled: true,
                        isEnabled: true,
                        speedingThresholdMph: 35,
                    },
                    forwardCollisionDetectionAlerts: { hasInCabAudioAlertsEnabled: true, isEnabled: true },
                    harshEventSensitivity: {},
                    harshEventSensitivityV2: {},
                    policyViolationsDetectionAlerts: {
                        hasInCabAudioAlertsEnabled: true,
                        isEnabled: true,
                        speedingThresholdMph: 5,
                    },
                    rollingStopDetectionAlerts: { isEnabled: true, speedingThresholdMph: 0 },
                    safetyScoreConfiguration: {
                        aiInattentiveDrivingDetectionWeight: 2,
                        crashWeight: 1,
                        defensiveDrivingWeight: 0,
                        didNotYieldWeight: 0,
                        drowsyWeight: 0,
                        eatingDrinkingWeight: 0,
                        followingDistanceModerateWeight: 0,
                        followingDistanceSevereWeight: 0,
                        followingDistanceWeight: 2,
                        forwardCollisionWarningWeight: 0,
                        harshAccelWeight: 1,
                        harshBrakeWeight: 1,
                        harshTurnWeight: 1,
                        heavySpeedingWeight: 1,
                        inattentiveDrivingWeight: 0,
                        laneDepartureWeight: 0,
                        lateResponseWeight: 0,
                        lightSpeedingWeight: 0,
                        maxSpeedWeight: 1,
                        mobileUsageWeight: 0,
                        moderateSpeedingWeight: 1,
                        nearCollisionWeight: 0,
                        noSeatbeltWeight: 0,
                        obstructedCameraWeight: 0,
                        ranRedLightWeight: 0,
                        rollingStopWeight: 0,
                        severeSpeedingWeight: 1,
                        smokingWeight: 0,
                        speedingWeight: 0,
                        vulnerableRoadUserWeight: 0,
                    },
                    safetyScoreTarget: 90,
                    speedingSettings: {
                        severityLevels: [
                            { durationMs: 60, isEnabled: true, severityLevel: "light", speedOverLimitThreshold: 10 },
                        ],
                    },
                    voiceCoaching: { isEnabled: true, speedingThresholdMph: 10 },
                },
            ],
        };
        server
            .mockEndpoint()
            .get("/fleet/settings/safety")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.settings.safety.get();
        expect(response).toEqual({
            data: [
                {
                    defaultVehicleType: "off",
                    distractedDrivingDetectionAlerts: {
                        isEnabled: true,
                    },
                    followingDistanceDetectionAlerts: {
                        durationMs: 15000,
                        hasInCabAudioAlertsEnabled: true,
                        isEnabled: true,
                        speedingThresholdMph: 35,
                    },
                    forwardCollisionDetectionAlerts: {
                        hasInCabAudioAlertsEnabled: true,
                        isEnabled: true,
                    },
                    harshEventSensitivity: {},
                    harshEventSensitivityV2: {},
                    policyViolationsDetectionAlerts: {
                        hasInCabAudioAlertsEnabled: true,
                        isEnabled: true,
                        speedingThresholdMph: 5,
                    },
                    rollingStopDetectionAlerts: {
                        isEnabled: true,
                        speedingThresholdMph: 0,
                    },
                    safetyScoreConfiguration: {
                        aiInattentiveDrivingDetectionWeight: 2,
                        crashWeight: 1,
                        defensiveDrivingWeight: 0,
                        didNotYieldWeight: 0,
                        drowsyWeight: 0,
                        eatingDrinkingWeight: 0,
                        followingDistanceModerateWeight: 0,
                        followingDistanceSevereWeight: 0,
                        followingDistanceWeight: 2,
                        forwardCollisionWarningWeight: 0,
                        harshAccelWeight: 1,
                        harshBrakeWeight: 1,
                        harshTurnWeight: 1,
                        heavySpeedingWeight: 1,
                        inattentiveDrivingWeight: 0,
                        laneDepartureWeight: 0,
                        lateResponseWeight: 0,
                        lightSpeedingWeight: 0,
                        maxSpeedWeight: 1,
                        mobileUsageWeight: 0,
                        moderateSpeedingWeight: 1,
                        nearCollisionWeight: 0,
                        noSeatbeltWeight: 0,
                        obstructedCameraWeight: 0,
                        ranRedLightWeight: 0,
                        rollingStopWeight: 0,
                        severeSpeedingWeight: 1,
                        smokingWeight: 0,
                        speedingWeight: 0,
                        vulnerableRoadUserWeight: 0,
                    },
                    safetyScoreTarget: 90,
                    speedingSettings: {
                        severityLevels: [
                            {
                                durationMs: 60,
                                isEnabled: true,
                                severityLevel: "light",
                                speedOverLimitThreshold: 10,
                            },
                        ],
                    },
                    voiceCoaching: {
                        isEnabled: true,
                        speedingThresholdMph: 10,
                    },
                },
            ],
        });
    });
});
