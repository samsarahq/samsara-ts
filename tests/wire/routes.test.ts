/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool.js";
import { SamsaraClient } from "../../src/Client";

describe("Routes", () => {
    test("create", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({ token: "test", version: "2025-05-12", environment: server.baseUrl });
        const rawRequestBody = { name: "Bid 123", stops: [{}] };
        const rawResponseBody = {
            data: {
                actualRouteEndTime: "2019-06-13T19:08:25Z",
                actualRouteStartTime: "2019-06-13T19:08:25Z",
                driver: { externalIds: { key: "value" }, id: "45646", name: "Driver Bob" },
                externalIds: { key: "value" },
                id: "342341",
                name: "Bid 123",
                notes: "These are my notes",
                orgLocalTimezone: "America/Los_Angeles",
                recurringRouteLiveSharingLinks: [
                    {
                        expiresAtTime: "2020-01-27T07:06:25Z",
                        liveSharingUrl: "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                        name: "Name",
                    },
                ],
                scheduledRouteEndTime: "2019-06-13T19:08:25Z",
                scheduledRouteStartTime: "2019-06-13T19:08:25Z",
                settings: { routeCompletionCondition: "arriveLastStop", routeStartingCondition: "departFirstStop" },
                stops: [
                    {
                        actualArrivalTime: "2006-01-02T08:04:05Z",
                        actualDepartureTime: "2006-01-02T08:04:05Z",
                        address: { id: "494123", name: "Company Office #1" },
                        documents: [{ id: "494123", name: "Fuel Receipt Wichita" }],
                        enRouteTime: "2006-01-02T08:04:05Z",
                        eta: "2006-01-02T08:04:05Z",
                        id: "324231",
                        liveSharingUrl: "https://cloud.samsara.com/fleet/viewer/job/fleet_viewer_token",
                        locationLiveSharingLinks: [
                            {
                                expiresAtTime: "2020-01-27T07:06:25Z",
                                liveSharingUrl:
                                    "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                                name: "Name",
                            },
                        ],
                        name: "Stop #1",
                        notes: "These are my notes",
                        ontimeWindowAfterArrivalMs: 300000,
                        ontimeWindowBeforeArrivalMs: 300000,
                        scheduledArrivalTime: "2019-06-13T19:08:25Z",
                        scheduledDepartureTime: "2019-06-13T19:08:25Z",
                        singleUseLocation: {
                            address: "1234 Main St, San Jose, CA",
                            latitude: 123.456,
                            longitude: 37.459,
                        },
                        skippedTime: "2006-01-02T08:04:05Z",
                        state: "unassigned",
                    },
                ],
                vehicle: { externalIds: { key: "value" }, id: "494123", name: "Fleet Truck #1" },
            },
        };
        server
            .mockEndpoint()
            .post("/fleet/routes")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.routes.create({
            name: "Bid 123",
            stops: [{}],
        });
        expect(response).toEqual({
            data: {
                actualRouteEndTime: "2019-06-13T19:08:25Z",
                actualRouteStartTime: "2019-06-13T19:08:25Z",
                driver: {
                    externalIds: {
                        key: "value",
                    },
                    id: "45646",
                    name: "Driver Bob",
                },
                externalIds: {
                    key: "value",
                },
                id: "342341",
                name: "Bid 123",
                notes: "These are my notes",
                orgLocalTimezone: "America/Los_Angeles",
                recurringRouteLiveSharingLinks: [
                    {
                        expiresAtTime: "2020-01-27T07:06:25Z",
                        liveSharingUrl: "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                        name: "Name",
                    },
                ],
                scheduledRouteEndTime: "2019-06-13T19:08:25Z",
                scheduledRouteStartTime: "2019-06-13T19:08:25Z",
                settings: {
                    routeCompletionCondition: "arriveLastStop",
                    routeStartingCondition: "departFirstStop",
                },
                stops: [
                    {
                        actualArrivalTime: "2006-01-02T08:04:05Z",
                        actualDepartureTime: "2006-01-02T08:04:05Z",
                        address: {
                            id: "494123",
                            name: "Company Office #1",
                        },
                        documents: [
                            {
                                id: "494123",
                                name: "Fuel Receipt Wichita",
                            },
                        ],
                        enRouteTime: "2006-01-02T08:04:05Z",
                        eta: "2006-01-02T08:04:05Z",
                        id: "324231",
                        liveSharingUrl: "https://cloud.samsara.com/fleet/viewer/job/fleet_viewer_token",
                        locationLiveSharingLinks: [
                            {
                                expiresAtTime: "2020-01-27T07:06:25Z",
                                liveSharingUrl:
                                    "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                                name: "Name",
                            },
                        ],
                        name: "Stop #1",
                        notes: "These are my notes",
                        ontimeWindowAfterArrivalMs: 300000,
                        ontimeWindowBeforeArrivalMs: 300000,
                        scheduledArrivalTime: "2019-06-13T19:08:25Z",
                        scheduledDepartureTime: "2019-06-13T19:08:25Z",
                        singleUseLocation: {
                            address: "1234 Main St, San Jose, CA",
                            latitude: 123.456,
                            longitude: 37.459,
                        },
                        skippedTime: "2006-01-02T08:04:05Z",
                        state: "unassigned",
                    },
                ],
                vehicle: {
                    externalIds: {
                        key: "value",
                    },
                    id: "494123",
                    name: "Fleet Truck #1",
                },
            },
        });
    });

    test("get", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({ token: "test", version: "2025-05-12", environment: server.baseUrl });

        const rawResponseBody = {
            data: {
                actualRouteEndTime: "2019-06-13T19:08:25Z",
                actualRouteStartTime: "2019-06-13T19:08:25Z",
                driver: { externalIds: { key: "value" }, id: "45646", name: "Driver Bob" },
                externalIds: { key: "value" },
                id: "342341",
                name: "Bid 123",
                notes: "These are my notes",
                orgLocalTimezone: "America/Los_Angeles",
                recurringRouteLiveSharingLinks: [
                    {
                        expiresAtTime: "2020-01-27T07:06:25Z",
                        liveSharingUrl: "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                        name: "Name",
                    },
                ],
                scheduledRouteEndTime: "2019-06-13T19:08:25Z",
                scheduledRouteStartTime: "2019-06-13T19:08:25Z",
                settings: { routeCompletionCondition: "arriveLastStop", routeStartingCondition: "departFirstStop" },
                stops: [
                    {
                        actualArrivalTime: "2006-01-02T08:04:05Z",
                        actualDepartureTime: "2006-01-02T08:04:05Z",
                        address: { id: "494123", name: "Company Office #1" },
                        documents: [{ id: "494123", name: "Fuel Receipt Wichita" }],
                        enRouteTime: "2006-01-02T08:04:05Z",
                        eta: "2006-01-02T08:04:05Z",
                        id: "324231",
                        liveSharingUrl: "https://cloud.samsara.com/fleet/viewer/job/fleet_viewer_token",
                        locationLiveSharingLinks: [
                            {
                                expiresAtTime: "2020-01-27T07:06:25Z",
                                liveSharingUrl:
                                    "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                                name: "Name",
                            },
                        ],
                        name: "Stop #1",
                        notes: "These are my notes",
                        ontimeWindowAfterArrivalMs: 300000,
                        ontimeWindowBeforeArrivalMs: 300000,
                        scheduledArrivalTime: "2019-06-13T19:08:25Z",
                        scheduledDepartureTime: "2019-06-13T19:08:25Z",
                        singleUseLocation: {
                            address: "1234 Main St, San Jose, CA",
                            latitude: 123.456,
                            longitude: 37.459,
                        },
                        skippedTime: "2006-01-02T08:04:05Z",
                        state: "unassigned",
                    },
                ],
                vehicle: { externalIds: { key: "value" }, id: "494123", name: "Fleet Truck #1" },
            },
        };
        server.mockEndpoint().get("/fleet/routes/id").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.routes.get("id");
        expect(response).toEqual({
            data: {
                actualRouteEndTime: "2019-06-13T19:08:25Z",
                actualRouteStartTime: "2019-06-13T19:08:25Z",
                driver: {
                    externalIds: {
                        key: "value",
                    },
                    id: "45646",
                    name: "Driver Bob",
                },
                externalIds: {
                    key: "value",
                },
                id: "342341",
                name: "Bid 123",
                notes: "These are my notes",
                orgLocalTimezone: "America/Los_Angeles",
                recurringRouteLiveSharingLinks: [
                    {
                        expiresAtTime: "2020-01-27T07:06:25Z",
                        liveSharingUrl: "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                        name: "Name",
                    },
                ],
                scheduledRouteEndTime: "2019-06-13T19:08:25Z",
                scheduledRouteStartTime: "2019-06-13T19:08:25Z",
                settings: {
                    routeCompletionCondition: "arriveLastStop",
                    routeStartingCondition: "departFirstStop",
                },
                stops: [
                    {
                        actualArrivalTime: "2006-01-02T08:04:05Z",
                        actualDepartureTime: "2006-01-02T08:04:05Z",
                        address: {
                            id: "494123",
                            name: "Company Office #1",
                        },
                        documents: [
                            {
                                id: "494123",
                                name: "Fuel Receipt Wichita",
                            },
                        ],
                        enRouteTime: "2006-01-02T08:04:05Z",
                        eta: "2006-01-02T08:04:05Z",
                        id: "324231",
                        liveSharingUrl: "https://cloud.samsara.com/fleet/viewer/job/fleet_viewer_token",
                        locationLiveSharingLinks: [
                            {
                                expiresAtTime: "2020-01-27T07:06:25Z",
                                liveSharingUrl:
                                    "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                                name: "Name",
                            },
                        ],
                        name: "Stop #1",
                        notes: "These are my notes",
                        ontimeWindowAfterArrivalMs: 300000,
                        ontimeWindowBeforeArrivalMs: 300000,
                        scheduledArrivalTime: "2019-06-13T19:08:25Z",
                        scheduledDepartureTime: "2019-06-13T19:08:25Z",
                        singleUseLocation: {
                            address: "1234 Main St, San Jose, CA",
                            latitude: 123.456,
                            longitude: 37.459,
                        },
                        skippedTime: "2006-01-02T08:04:05Z",
                        state: "unassigned",
                    },
                ],
                vehicle: {
                    externalIds: {
                        key: "value",
                    },
                    id: "494123",
                    name: "Fleet Truck #1",
                },
            },
        });
    });

    test("delete", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({ token: "test", version: "2025-05-12", environment: server.baseUrl });

        server.mockEndpoint().delete("/fleet/routes/id").respondWith().statusCode(200).build();

        const response = await client.routes.delete("id");
        expect(response).toEqual(undefined);
    });

    test("update", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({ token: "test", version: "2025-05-12", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = {
            data: {
                actualRouteEndTime: "2019-06-13T19:08:25Z",
                actualRouteStartTime: "2019-06-13T19:08:25Z",
                driver: { externalIds: { key: "value" }, id: "45646", name: "Driver Bob" },
                externalIds: { key: "value" },
                id: "342341",
                name: "Bid 123",
                notes: "These are my notes",
                orgLocalTimezone: "America/Los_Angeles",
                recurringRouteLiveSharingLinks: [
                    {
                        expiresAtTime: "2020-01-27T07:06:25Z",
                        liveSharingUrl: "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                        name: "Name",
                    },
                ],
                scheduledRouteEndTime: "2019-06-13T19:08:25Z",
                scheduledRouteStartTime: "2019-06-13T19:08:25Z",
                settings: { routeCompletionCondition: "arriveLastStop", routeStartingCondition: "departFirstStop" },
                stops: [
                    {
                        actualArrivalTime: "2006-01-02T08:04:05Z",
                        actualDepartureTime: "2006-01-02T08:04:05Z",
                        address: { id: "494123", name: "Company Office #1" },
                        documents: [{ id: "494123", name: "Fuel Receipt Wichita" }],
                        enRouteTime: "2006-01-02T08:04:05Z",
                        eta: "2006-01-02T08:04:05Z",
                        id: "324231",
                        liveSharingUrl: "https://cloud.samsara.com/fleet/viewer/job/fleet_viewer_token",
                        locationLiveSharingLinks: [
                            {
                                expiresAtTime: "2020-01-27T07:06:25Z",
                                liveSharingUrl:
                                    "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                                name: "Name",
                            },
                        ],
                        name: "Stop #1",
                        notes: "These are my notes",
                        ontimeWindowAfterArrivalMs: 300000,
                        ontimeWindowBeforeArrivalMs: 300000,
                        scheduledArrivalTime: "2019-06-13T19:08:25Z",
                        scheduledDepartureTime: "2019-06-13T19:08:25Z",
                        singleUseLocation: {
                            address: "1234 Main St, San Jose, CA",
                            latitude: 123.456,
                            longitude: 37.459,
                        },
                        skippedTime: "2006-01-02T08:04:05Z",
                        state: "unassigned",
                    },
                ],
                vehicle: { externalIds: { key: "value" }, id: "494123", name: "Fleet Truck #1" },
            },
        };
        server
            .mockEndpoint()
            .patch("/fleet/routes/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.routes.update("id");
        expect(response).toEqual({
            data: {
                actualRouteEndTime: "2019-06-13T19:08:25Z",
                actualRouteStartTime: "2019-06-13T19:08:25Z",
                driver: {
                    externalIds: {
                        key: "value",
                    },
                    id: "45646",
                    name: "Driver Bob",
                },
                externalIds: {
                    key: "value",
                },
                id: "342341",
                name: "Bid 123",
                notes: "These are my notes",
                orgLocalTimezone: "America/Los_Angeles",
                recurringRouteLiveSharingLinks: [
                    {
                        expiresAtTime: "2020-01-27T07:06:25Z",
                        liveSharingUrl: "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                        name: "Name",
                    },
                ],
                scheduledRouteEndTime: "2019-06-13T19:08:25Z",
                scheduledRouteStartTime: "2019-06-13T19:08:25Z",
                settings: {
                    routeCompletionCondition: "arriveLastStop",
                    routeStartingCondition: "departFirstStop",
                },
                stops: [
                    {
                        actualArrivalTime: "2006-01-02T08:04:05Z",
                        actualDepartureTime: "2006-01-02T08:04:05Z",
                        address: {
                            id: "494123",
                            name: "Company Office #1",
                        },
                        documents: [
                            {
                                id: "494123",
                                name: "Fuel Receipt Wichita",
                            },
                        ],
                        enRouteTime: "2006-01-02T08:04:05Z",
                        eta: "2006-01-02T08:04:05Z",
                        id: "324231",
                        liveSharingUrl: "https://cloud.samsara.com/fleet/viewer/job/fleet_viewer_token",
                        locationLiveSharingLinks: [
                            {
                                expiresAtTime: "2020-01-27T07:06:25Z",
                                liveSharingUrl:
                                    "https://cloud.samsara.com/o/123456/fleet/viewer/address/gEAitEnnOwcv92cuPzcU",
                                name: "Name",
                            },
                        ],
                        name: "Stop #1",
                        notes: "These are my notes",
                        ontimeWindowAfterArrivalMs: 300000,
                        ontimeWindowBeforeArrivalMs: 300000,
                        scheduledArrivalTime: "2019-06-13T19:08:25Z",
                        scheduledDepartureTime: "2019-06-13T19:08:25Z",
                        singleUseLocation: {
                            address: "1234 Main St, San Jose, CA",
                            latitude: 123.456,
                            longitude: 37.459,
                        },
                        skippedTime: "2006-01-02T08:04:05Z",
                        state: "unassigned",
                    },
                ],
                vehicle: {
                    externalIds: {
                        key: "value",
                    },
                    id: "494123",
                    name: "Fleet Truck #1",
                },
            },
        });
    });
});
