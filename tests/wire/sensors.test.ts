// This file was auto-generated by Fern from our API Definition.

import { SamsaraClient } from "../../src/Client";
import { mockServerPool } from "../mock-server/MockServerPool";

describe("SensorsClient", () => {
    test("V1getSensorsCargo", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });
        const rawRequestBody = { sensors: [122] };
        const rawResponseBody = {
            groupId: 101,
            sensors: [
                {
                    cargoEmpty: true,
                    cargoStatusTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Trailer Cargo V1Sensor",
                    redEyeDistance: 175,
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        };
        server
            .mockEndpoint()
            .post("/v1/sensors/cargo")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sensors.v1GetSensorsCargo({
            sensors: [122],
        });
        expect(response).toEqual({
            groupId: 101,
            sensors: [
                {
                    cargoEmpty: true,
                    cargoStatusTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Trailer Cargo V1Sensor",
                    redEyeDistance: 175,
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        });
    });

    test("V1getSensorsDoor", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });
        const rawRequestBody = { sensors: [122] };
        const rawResponseBody = {
            groupId: 101,
            sensors: [
                {
                    doorClosed: true,
                    doorStatusTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Trailer Door V1Sensor",
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        };
        server
            .mockEndpoint()
            .post("/v1/sensors/door")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sensors.v1GetSensorsDoor({
            sensors: [122],
        });
        expect(response).toEqual({
            groupId: 101,
            sensors: [
                {
                    doorClosed: true,
                    doorStatusTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Trailer Door V1Sensor",
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        });
    });

    test("V1getSensorsHistory", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });
        const rawRequestBody = {
            endMs: 1462881998034,
            series: [{ field: "ambientTemperature", widgetId: 1 }],
            startMs: 1462878398034,
            stepMs: 3600000,
        };
        const rawResponseBody = { results: [{ series: [1], timeMs: 1453449599999 }] };
        server
            .mockEndpoint()
            .post("/v1/sensors/history")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sensors.v1GetSensorsHistory({
            endMs: 1462881998034,
            series: [
                {
                    field: "ambientTemperature",
                    widgetId: 1,
                },
            ],
            startMs: 1462878398034,
            stepMs: 3600000,
        });
        expect(response).toEqual({
            results: [
                {
                    series: [1],
                    timeMs: 1453449599999,
                },
            ],
        });
    });

    test("V1getSensorsHumidity", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });
        const rawRequestBody = { sensors: [122] };
        const rawResponseBody = {
            groupId: 101,
            sensors: [
                {
                    humidity: 53,
                    humidityTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Freezer Humidity V1Sensor",
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        };
        server
            .mockEndpoint()
            .post("/v1/sensors/humidity")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sensors.v1GetSensorsHumidity({
            sensors: [122],
        });
        expect(response).toEqual({
            groupId: 101,
            sensors: [
                {
                    humidity: 53,
                    humidityTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Freezer Humidity V1Sensor",
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        });
    });

    test("V1getSensors", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });

        const rawResponseBody = { sensors: [{ id: 123, macAddress: "11:11:11:11:11:11", name: "Freezer ABC" }] };
        server.mockEndpoint().post("/v1/sensors/list").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.sensors.v1GetSensors();
        expect(response).toEqual({
            sensors: [
                {
                    id: 123,
                    macAddress: "11:11:11:11:11:11",
                    name: "Freezer ABC",
                },
            ],
        });
    });

    test("V1getSensorsTemperature", async () => {
        const server = mockServerPool.createServer();
        const client = new SamsaraClient({
            maxRetries: 0,
            token: "test",
            version: "2025-06-11",
            environment: server.baseUrl,
        });
        const rawRequestBody = { sensors: [122] };
        const rawResponseBody = {
            groupId: 101,
            sensors: [
                {
                    ambientTemperature: 11057,
                    ambientTemperatureTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Freezer Temp V1Sensor",
                    probeTemperature: -20145,
                    probeTemperatureTime: "2019-04-17T16:42:55Z",
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        };
        server
            .mockEndpoint()
            .post("/v1/sensors/temperature")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sensors.v1GetSensorsTemperature({
            sensors: [122],
        });
        expect(response).toEqual({
            groupId: 101,
            sensors: [
                {
                    ambientTemperature: 11057,
                    ambientTemperatureTime: "2019-04-17T16:42:55Z",
                    id: 122,
                    name: "Freezer Temp V1Sensor",
                    probeTemperature: -20145,
                    probeTemperatureTime: "2019-04-17T16:42:55Z",
                    trailerId: 123,
                    vehicleId: 124,
                },
            ],
        });
    });
});
